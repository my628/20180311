# URDF和SRDF



## URDF

MoveIt2 以 URDF（统一机器人描述格式）开始，这是在 ROS 和 ROS2 中描述机器人的原生格式。
在本教程中，你将找到 URDF 的资源、重要提示以及 MoveIt2 特定要求的列表。



## URDF资源

- URDF ROS Wiki 页面 - URDF ROS Wiki 页面是有关 URDF 的大多数信息的来源。
- URDF 教程 - 使用 URDF 的教程。
- SOLIDWORKS URDF 插件 - 该插件可让您直接从 SOLIDWORKS 模型生成 URDF。



## 重要提示

本节包含一组确保你生成的 URDF 可以与 MoveIt2 一起使用的提示。
在开始将 MoveIt2 与你的机器人一起使用之前，请确保您阅读了所有这些提示。



### 关节名称中的特殊字符

关节名称不应包含以下任何特殊字符：-,[,],(,),

我们希望能够尽快摆脱这些对关节名称的限制。



### 安全限制

除了机器人的关节限制之外，一些 URDF 还设置了安全限制。
以下是为熊猫头平移关节指定的安全控制器示例：

```xml
<safety_controller k_position="100" k_velocity="1.5" soft_lower_limit="-2.857" soft_upper_limit="2.857"/>
```

“soft_lower_limit”字段和“soft_upper_limit”字段指定该关节的关节位置限制。
MoveIt2 会将这些限制与 URDF 中指定的关节的硬限制进行比较，并选择更保守的限制。

> 如果safe_controller中的“soft_lower_limit”和“soft_upper_limit”设置为0.0，你的关节将无法移动。
> MoveIt2 依赖于你指定正确的机器人模型。



## 碰撞检查

MoveIt2 使用 URDF 中指定的网格进行碰撞检查。
URDF 允许你分别指定两组网格用于可视化和碰撞检查。
一般来说，可视化网格可以是详细而漂亮的，但碰撞网格应该不太详细。
网格中的三角形数量会影响碰撞检查机器人链接所需的时间。
整个机器人的三角形数量应该在几千个数量级。



## 测试你的 URDF

测试你的 URDF 并确保一切正常非常重要。
ROS URDF 包提供了一个 check_urdf 工具。
要使用 check_urdf 工具验证你的 URDF，请按照此处的说明进行操作。



## URDF 示例

有很多 URDF 可用于使用 ROS 的机器人。

- URDF 示例 - 来自 ROS 社区的 URDF 列表。



## SRDF

SRDF 或语义机器人描述格式是对 URDF 的补充，并指定关节组、默认机器人配置、附加碰撞检查信息以及完全指定机器人姿势可能需要的附加变换。
生成 SRDF 的推荐方法是使用 MoveIt 设置助手。



## 虚拟关节

URDF 仅包含有关机器人物理关节的信息。通常，需要定义额外的关节来指定机器人上根链接相对于世界坐标系的姿态。
在这种情况下，使用虚拟关节来指定此连接。
例如，像 PR2 这样在平面内移动的移动机器人是使用平面虚拟关节指定的，该关节将世界坐标系附加到机器人的框架上。
固定机器人（如工业机械手）应使用固定关节连接到世界。



## 被动关节

被动关节是机器人上未驱动的关节，例如差动驱动机器人上的被动脚轮。
它们在 SRDF 中单独指定，以确保运动规划或控制管道中的不同组件知道无法直接控制关节。
如果你的机器人具有非驱动脚轮，则应将其指定为被动脚轮。



## 组

“组”（有时称为“JointGroup”或“计划组”）是 MoveIt2 中的核心概念。
MoveIt2 始终作用于特定组。
MoveIt2 将只考虑移动它正在计划的组中的关节——其他关节保持静止。（机器人中所有关节都可以移动的运动计划可以通过创建一个包含所有关节的组来实现。）
组只是关节和链接的集合。
可以通过以下几种不同方式之一指定每个组：



### 关节集合

可以将组指定为关节的集合。
每个关节的所有子链接都会自动包含在组中。



### 链接集

也可以将组指定为链接的集合。
链接的所有父关节也包含在该组中。



### 串行链

使用基本链接和尖端链接指定串行链。
链中的末端链接是链中最后一个关节的子链接。
链中的基础链接是链中第一个关节的父链接。



### 子组的集合

组也可以是组的集合。
例如，你可以将 left_arm 和 right_arm 定义为两个组，然后定义一个名为 both_arms 的新组，其中包含这两个组。



### 末端执行器

机器人中的某些组可以被指定为末端执行器。
末端执行器通常通过固定关节连接到另一组（如手臂）。
请注意，在指定作为末端执行器的组时，确保末端执行器与其连接的父组之间没有公共链接非常重要。



## 自碰撞

默认自碰撞矩阵生成器（设置助手的一部分）在机器人上搜索可以安全地禁用碰撞检查的链接对，从而减少运动规划处理时间。
当这些链接对总是处于碰撞中，从不发生碰撞，在机器人默认位置发生碰撞或链接在运动链上彼此相邻时，这些链接对将被禁用。
采样密度指定要检查自碰撞的随机机器人位置数。
较高的密度需要更多的计算时间，而较低的密度则更有可能禁用不应禁用的对。默认值为 10,000 次碰撞检查。
碰撞检查是并行完成的，以减少处理时间。



## 机器人姿势

SRDF 还可以存储机器人的固定配置。
在这种情况下，SRDF 的一个典型示例是为机械手定义 HOME 位置。
配置以字符串 id 存储，可用于稍后恢复配置。




### SRDF 文档

有关 SRDF 语法的信息，请阅读 ROS SRDF Wiki 页面上的更多详细信息。
